---
title: "Policy or Partisanship: Replicating Results From An Analysis of Quasi-Experimental Evidence From Brexit"
author: "Trisha Prabhu"
date: "05/07/2021"
output: pdf_document
header-includes:
   - \usepackage{float}
---

### Acknowledgements

I'd like to thank Professor Jeff Gill, Le Bao, and the course staff of Gov 52 
for their unwavering support in this class and as I've pursued this project -- 
my immense gratitude to all of you.

Thanks also to my "Room 4" group; you made this class fun and memorable.

# I. Introduction: Overview of Original Paper

Note for Trisha: You still need to add citations here!

This replication examines the paper "Policy or Partisanship: Replicating Results 
From An Analysis of Quasi-Experimental Evidence From Brexit." In the paper, the
authors aim to explore one key question: "are voters motivated by policy
preferences, or partisan identities?" The authors answer the question in the
context of the UK's political system, exploiting the UK’s Brexit referendum -- 
which caused an abrupt change in the British Conservative Party’s stance on 
leaving the European Union, and via a vote “so narrow that it was more or less a 
coin flip.” The authors’ methodology is relatively simple: they employ an 
uninterrupted time-series design, examining panel survey data from the British 
Election Study to compare referendum attitudes and party affiliation in the data 
immediately before and after the referendum (“Wave 8” and “Wave 9” data, 
respectively). Given the brief gap between the 2 waves, and their ability to 
identify/eliminate potential confounders (e.g. a change in the Labour Party’s 
stance on Brexit), they assume their identification strategy is sound. 
They ultimately fit and run several linear regression models that find that 
voters are most motivated by policy: following Brexit, “Europhilic” (citizens 
that supported remaining in the EU) Conservatives disaffiliated from the 
Conservative party; indeed, the less Euroskeptic a Conservative was 
pre-referendum, the more likely they were to disaffiliate. The "policy story"
holds when examining pre-referendum non-Conservatives; here, the authors
determine that the more Euroskeptic pre-referendum non-Conservatives were,
the more likely they were to switch to the Conservative Party. 

The authors also explore various related questions, such as whether the 
intensity of pre-referendum Conservatives' partisanship influenced to what 
degree they followed their party as it adopted a new position; they ultimately 
find that the positive relationship between Conservatives' perception of their 
party's position on Brexit and their position on Brexit is strongest for the 
most partisan Conservatives. The authors also look at whether newly minted 
Conservative voters also updated their stances on other policy issues to further 
align themselves with the Conservative party; looking specifically at the issue
of redistribution, they find that this is indeed the case. The authors' other 
results/conclusions are discussed in detail in the next section.

In the next section, I replicate ^[The data and code used in the report can be 
obtained here:] the authors' main results (6 tables and 2 figures), providing my 
analyses/interpretation. Then, in the third section, I consider ways to extend 
the authors' work, in this case, by employing another regression method 
particularly suited to analyses with binary outcomes (such as switching parties) 
-- logistic regression.

# II. Replicated Results and Discussion

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load libraries:

library(foreign)
library(tidyverse)
library(ggplot2)
library(arm)
library(stargazer)
library(janitor)
library(ggthemes)
library(dplyr)
library(arm)
library(packrat)
library(sjPlot)

# Read in the various "waves" of data:

BES6 <- read.dta("~/Downloads/BES2015_W6_v3.9.dta")
BES7 <- read.dta("~/Downloads/BES2015_W7_v2.2-1.dta")
BES8 <- read.dta("~/Downloads/BES2015_W8_v2.3.dta")
BES9 <- read.dta("~/Downloads/BES2015_W9_v1.7.dta")
BES11 <- read.dta("~/Downloads/BES2015_W11_v1.5.dta")
BES13 <- read.dta("~/Downloads/BES2017_W13_v1.5.dta")

```

```{r, echo = FALSE}

### Let's begin by cleaning the data:

# Recode EU integration values:

BES8 <- BES8 %>%
  dplyr::mutate(EUIntegrationCon = case_when(EUIntegrationCon == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationCon == "1" ~ 1, EUIntegrationCon == "2" ~ 2,
                                      EUIntegrationCon == "3" ~ 3, EUIntegrationCon == "4" ~ 4,
                                      EUIntegrationCon == "5" ~ 5, EUIntegrationCon == "6" ~ 6,
                                      EUIntegrationCon == "7" ~ 7, EUIntegrationCon == "8" ~ 8,
                                      EUIntegrationCon == "9" ~ 9, EUIntegrationCon == "Protect our independence" ~ 10))
BES8 <- BES8 %>%
  dplyr::mutate(EUIntegrationLab = case_when(EUIntegrationLab == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationLab == "1" ~ 1, 
                                      EUIntegrationLab == "2" ~ 2,
                                      EUIntegrationLab == "3" ~ 3,
                                      EUIntegrationLab == "4" ~ 4,
                                      EUIntegrationLab == "5" ~ 5,
                                      EUIntegrationLab == "6" ~ 6,
                                      EUIntegrationLab == "7" ~ 7,
                                      EUIntegrationLab == "8" ~ 8,
                                      EUIntegrationLab == "9" ~ 9,
                                      EUIntegrationLab == "Protect our independence" ~ 10))

BES8 <- BES8 %>%
  dplyr::mutate(EUIntegrationSelf = case_when(EUIntegrationSelf == "Unite fully with the European Union" ~ 0,
                                       EUIntegrationSelf == "1" ~ 1, 
                                       EUIntegrationSelf == "2" ~ 2,
                                       EUIntegrationSelf == "3" ~ 3,
                                       EUIntegrationSelf == "4" ~ 4,
                                       EUIntegrationSelf == "5" ~ 5,
                                       EUIntegrationSelf == "6" ~ 6,
                                       EUIntegrationSelf == "7" ~ 7,
                                       EUIntegrationSelf == "8" ~ 8,
                                       EUIntegrationSelf == "9" ~ 9,
                                       EUIntegrationSelf == "Protect our independence" ~ 10))

BES9 <- BES9 %>%
  mutate(EUIntegrationCon = case_when(EUIntegrationCon == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationCon == "1" ~ 1, EUIntegrationCon == "2" ~ 2,
                                      EUIntegrationCon == "3" ~ 3, EUIntegrationCon == "4" ~ 4,
                                      EUIntegrationCon == "5" ~ 5, EUIntegrationCon == "6" ~ 6,
                                      EUIntegrationCon == "7" ~ 7, EUIntegrationCon == "8" ~ 8,
                                      EUIntegrationCon == "9" ~ 9, EUIntegrationCon == "Protect our independence" ~ 10))

BES9 <- BES9 %>%
  mutate(EUIntegrationLab = case_when(EUIntegrationLab == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationLab == "1" ~ 1, EUIntegrationLab == "2" ~ 2,
                                      EUIntegrationLab == "3" ~ 3, EUIntegrationLab == "4" ~ 4,
                                      EUIntegrationLab == "5" ~ 5, EUIntegrationLab == "6" ~ 6,
                                      EUIntegrationLab == "7" ~ 7, EUIntegrationLab == "8" ~ 8,
                                      EUIntegrationLab == "9" ~ 9, EUIntegrationLab == "Protect our independence" ~ 10))


BES9 <- BES9 %>%
  mutate(EUIntegrationSelf = case_when(EUIntegrationSelf == "Unite fully with the European Union" ~ 0,
                                       EUIntegrationSelf == "1" ~ 1, EUIntegrationSelf == "2" ~ 2,
                                       EUIntegrationSelf == "3" ~ 3, EUIntegrationSelf == "4" ~ 4,
                                       EUIntegrationSelf == "5" ~ 5, EUIntegrationSelf == "6" ~ 6,
                                       EUIntegrationSelf == "7" ~ 7, EUIntegrationSelf == "8" ~ 8,
                                       EUIntegrationSelf == "9" ~ 9, EUIntegrationSelf == "Protect our independence" ~ 10))

```

```{r, echo = FALSE}

### Let's now do some analyses and replication of figures:

# Let's analyze the strength of our assumption that there was a sudden change
# in Conservative party positioning, unaffected by other important omitted 
# variables (e.g. a similar change in Labor party positioning).

# Examine perceived Euroskepticism of Conservatives and Labour in Waves 8 and 9
# We're looking at a 0 - 10 scale, with 10 being most Euroskeptic
# Note that Wave 8 is immediately leading up to the referendum; Wave 9 is
# immediately after

con_before <- mean(BES8$EUIntegrationCon, na.rm=TRUE)
con_after <- mean(BES9$EUIntegrationCon, na.rm=TRUE)
lab_before <- mean(BES8$EUIntegrationLab, na.rm=TRUE)
lab_after <-mean(BES9$EUIntegrationLab, na.rm=TRUE)

#  Percentage change in Conservative party positioning:

change <- (con_after - con_before)/con_before

# From the paper: "Only the conservatives exhibited a sudden change in
# positioning on Brexit"; here, we see the average perceived Euroskepticism
# of the Conservatives increase by 8%.

```

```{r, echo = FALSE}

### Let's create Table 1:

# And now, for some other relevant cleaning:

# Create race variable:

BES8$white <- ifelse(BES8$profile_ethnicity == "White British" | BES8$profile_ethnicity == "Any other white background", 1, 0)

BES8$EUIntegrationCon8 <- BES8$EUIntegrationCon
BES8$partyId8 <- BES8$partyId
BES8$EUIntegrationSelf8 <- BES8$EUIntegrationSelf 

# Create Conservative partyID, for both Waves 8 and 9:

BES8$Con <- ifelse(BES8$partyId =="Conservative", 1, 0)
BES8$Con8 <- BES8$Con 

BES9$Con <- ifelse(BES9$partyId=="Conservative", 1, 0)
BES9$Con9 <- BES9$Con 

BES9$EUIntegrationCon9 <- BES9$EUIntegrationCon
BES9$EUIntegrationSelf9 <- BES9$EUIntegrationSelf 
BES9$partyId9 <- BES9$partyId

# Let's now answer the main question of the paper: do voters switch their party identification as a
# function of their Euroskepticism?

# Let's subset Wave 8 to Conservatives:

BES8subcons <- BES8[BES8$partyId == "Conservative",]

# Let's merge the Conservatives in Wave 8 to the BE9 (post-referendum) data,
# so we can look at switching:

merged <- merge(BES8subcons, BES9, by= "id")

# And here we go! Table 1:

# Let's create a variable that indicates switching:

merged$partyswitcher <- ifelse(merged$partyId8 != merged$partyId9, 1, 0)

# Table 1:
# Note that the independent variable here is the respondent's self-reported level
# of Euroskepticism, on a 0 - 10 scale:

table1reg <- lm(partyswitcher ~ EUIntegrationSelf8, data = merged)

# Let's create a variable that represents the change (post-referendum) in 
# perceived Euroskepticism of Conservatives:

merged$Conchange <- merged$EUIntegrationCon9 - merged$EUIntegrationCon8

# And include it in our regression as an interaction:

intreg1 <- lm(partyswitcher ~ EUIntegrationSelf8 * Conchange, 
              data = merged)

# From the paper (Page 11): the interaction is negative and significant: less 
# Euroskeptic Conservatives who perceive that the party has become increasingly 
# Euroskeptic are especially likely to reject it.

# And now, let's throw everything in: 

merged$country.x <- as.factor(merged$country.x)

intreg1a <- lm(partyswitcher ~ EUIntegrationSelf8 * Conchange + age.x + gender.x 
               + white + country.x, data = merged)

```

```{r, results = 'asis', echo = FALSE}

# And now, let's create our table:

stargazer(table1reg, intreg1, intreg1a, 
          title = "Euroskepticism and Defection from the Conservatives",
          covariate.labels = c("Pre-Referendum Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism", 
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales", 
                               "Pre-Referendum Euroskepticism:Perceived Change in Conservative Euroskepticism", 
                               "Constant"),
          dep.var.labels   = "Defect from Conservatives",
          no.space = TRUE, star.cutoffs = c(0.05, 0.01, 0.001),
          font.size = "tiny",
          header = FALSE) 

```

I began by replicating Table 1 of the paper, which aims to answer the paper's
most fundamental question: are voters motivated by policy or partisanship? As 
discussed, the authors operationalize that question by examining if/how party 
affiliation evolved in the wake of Brexit. In Table 1, the authors examine
defection from the Conservative Party. Like the authors, I began by focusing in 
on Waves 8 and 9 of the data (immediately pre and post-referendum). I first 
created a "Conservative Party ID" variable that indicated if, for each wave, 
a given unit reported being a member of the Conservative party; I then used
that information to subset to Wave 8 Conservatives, which I then merged with the 
Wave 9 data. I also created another variable, "partyswitcher," that indicated 
switching out of the Conservative Party -- a Wave 8 Unit that did not report 
affiliating with the Conservatives in Wave 9. Like the authors, I then regressed 
this "partyswitcher" variable on the respondent's self-reported level of 
Euroskepticism (on a 0 - 10 scale) pre-referendum; in 2 other regressions, I 
also included the perceived change in Euroskepticism of Conservatives as an 
interaction, as well as threw in a range of demographic information (e.g. age, gender, 
etc.). The coefficient associated with the first regression, which is significant at 
the 0.05 level, suggests that "a one-point increase in pre-referendum 
Euroskepticism yields a 0.3 percent decrease in the probability of defection" 
(Schonfeld and Winter-Levy 2019). The interaction coefficient in the second/third 
column of the data is also significant at the 0.05 level; the negative value 
indicates that " less Euroskeptic Conservatives who perceive that the party has 
become increasingly Euroskeptic are especially likely to reject it" (Schonfeld 
and Winter-Levy 2019). Policy, not partisanship, it seems, is what matters.

```{r, echo = FALSE}

# From the paper (Page 11): "of those who identified as Conservative before the 
# referendum, 9.0 percent of respondents with pre-referendum Euroskepticism 
# scores of 4-5 (on a ten-point scale), 9.8 percent of those with scores of 2-3, 
# and 9.9 percent of those with scores of 0-1 turned their backs on the party. 
# The less Euroskeptic a voter was before the referendum, the more likely they 
# were to disaffiliate from the party in the aftermath of its embrace of 
# Brexit."

merge45 <- merged[merged$EUIntegrationSelf8=="5" | merged$EUIntegrationSelf8=="4",]
merge23 <- merged[merged$EUIntegrationSelf8=="3" | merged$EUIntegrationSelf8=="2",]
merge01 <- merged[merged$EUIntegrationSelf8=="1" | merged$EUIntegrationSelf8=="0",]

mean45 <- mean(merge45$partyswitcher,na.rm=TRUE)
mean23 <- mean(merge23$partyswitcher,na.rm=TRUE)
mean01 <- mean(merge01$partyswitcher,na.rm=TRUE)

```

```{r, echo = FALSE, warnings = FALSE, message = FALSE}

### Let's create Table 2:

# Let's now subset to pre-referendum non-Conservatives:

BES8notcons<- BES8[BES8$partyId != "Conservative",] 

# And now, let's merge that info. with our post-referendum data:

merged2 <- merge(BES8notcons, BES9, by = "id")

# Who switches to Conservative post-referendum?

merged2$switchtocons <- ifelse(merged2$partyId9 == "Conservative", 1, 0)

# What's the average?

avg <- mean(merged2$switchtocons)

# Let's regress folks' self-reported pre-referendum level of Euroskepticism, on
# a scale from 0 - 10, on those who switch to Conservative post-referendum.

table2reg <- lm(merged2$switchtocons ~ merged2$EUIntegrationSelf8)

# Let's create a variable that represents the change (post-referendum) in 
# perceived Euroskepticism of Conservatives:

merged2$Conchange <- merged2$EUIntegrationCon9 - merged2$EUIntegrationCon8

# And include that variable as an interaction:

intreg2 <- lm(merged2$switchtocons ~ merged2$EUIntegrationSelf8 * merged2$Conchange)

# And now, let's throw everything in again:

intreg2a <- lm(merged2$switchtocons ~ merged2$EUIntegrationSelf8 * merged2$Conchange 
              + merged2$age.x + merged2$gender.x + merged2$white + 
                as.factor(merged2$country.x))

# From the paper: "A one-point increase in pre-referendum Euroskepticism 
# generates a .7 percent increase in the probability of switching loyalties to 
# the Conservatives. And the interaction term is positive and significant, 
# indicating that Euroskeptic non-Conservatives who perceived an increase in 
# Conservative Euroskepticism following the referendum were especially likely to 
#join the Conservatives."

```

```{r, results = 'asis', echo = FALSE, warnings = FALSE, message = FALSE}

# And finally, let's create Table 2, with everything:

stargazer(table2reg, intreg2, intreg2a, 
          title = "Euroskepticism and Joining the Conservatives",
          covariate.labels = c("Pre-Referendum Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism", 
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales", 
                               "Pre-Referendum Euroskepticism:Perceived Change in Conservative Euroskepticism", 
                               "Constant"),
          
          dep.var.labels   = "Joined Conservatives",
          no.space = TRUE, star.cutoffs = c(0.05, 0.01,0.001),
          font.size = "tiny",
          header = FALSE,
          table.placement = "H") 

```

That conclusion was strengthened upon creating/examining Table 2. Here, I
followed the same steps as I did to create Table 1, with alterations to examine
not defection, but joining the Conservatives. Thus, like the authors, I subsetted 
to pre-referendum (Wave 8) non-Conservatives, which I merged with the Wave 9 data, 
and created a switching variable "switchtocons" that indicated joining the 
Conservative Party  -- a Wave 8 unit that reported affiliating with the 
Conservative Party in Wave 9. I repeated the 3 same regressions as in Table 1, 
regressing my new switching variable, "switchtocons," on pre-referendum 
self-reported levels of Euroskepticism, including perceived changes in the 
Euroskepticism of the Conservative Party as an interaction, and finally, 
throwing a number of relevant predictors in. The "policy matters" finding held: 
as reported in the paper, the coefficient associated with the first regression, 
significant at the 0.001 level, suggests "a one-point increase in pre-referendum 
Euroskepticism generates a .7 percent increase in the probability of switching
loyalties to the Conservatives" (Schonfeld and Winter-Levy 2019).

```{r, echo = FALSE, warnings = FALSE, message = FALSE}

# Let's look at the percent switched for various groups of Euroskepticism 
# scores:

merge256 <- merged2[merged2$EUIntegrationSelf8 =="5" | merged2$EUIntegrationSelf8 =="6",]
merge278 <- merged2[merged2$EUIntegrationSelf8 =="7" | merged2$EUIntegrationSelf8 =="8",]
merge2910 <- merged2[merged2$EUIntegrationSelf8 =="9" | merged2$EUIntegrationSelf8 =="10",]

mean256 <- mean(merge256$switchtocons,na.rm=TRUE)
mean278 <- mean(merge278$switchtocons,na.rm=TRUE)
mean2910 <- mean(merge2910$switchtocons,na.rm=TRUE)

# From the paper: "Of those respondents who did not identify as Conservative 
# before the referendum, 2.8 percent with Euroskepticism scores of 5 or 6, 5.0 
# percent with scores of 7 or 8, and 6.7 percent with scores of 9 or 10 joined 
# the Conservatives. The more Euroskeptic the respondent, the more likely they 
# were to swing behind the Conservatives following the party’s shift in policy
# position.

```

```{r, echo = FALSE, warnings = FALSE, message = FALSE}

### But do strong partisans (e.g. very committed to Conservative) change their policy preferences?

# From the paper: "In Figure 1, we look at whether stronger Conservative 
# partisans were more likely to become Euroskeptic following the sudden, as-if 
# random change in Conservative positioning on Brexit than less staunch 
# supporters of the party."

# A respondent’s change in Euroskepticism between Waves 8 and 9:

merged$Euroskepticismchange <- merged$EUIntegrationSelf9 - merged$EUIntegrationSelf8

# Let's subset voters; we can run the same regression on each group:

mergestrong <- merged[merged$partyIdStrength.x=="Very strong",]
mergenotstrong <- merged[merged$partyIdStrength.x!="Very strong",]
   
# Let's create Table 3 (independent variable -- perceived increase in 
# Conservative Euroskepticism):

intreg3B <- lm(Euroskepticismchange ~ Conchange + gender.x + age.x + white 
               + country.x, data = mergestrong)

intreg3A <- lm(Euroskepticismchange ~ Conchange + gender.x + age.x + white 
               + country.x, data = mergenotstrong)

```

```{r, results = 'asis', echo = FALSE, warnings = FALSE, message = FALSE}

# And finally, our table:

stargazer(intreg3A, intreg3B, 
          title = "Individual Shifts in Euroskepticism",
          no.space = TRUE,
          covariate.labels = c("Perceived Change in Conservative Euroskepticism", 
                               "Female",
                               "Age",
                               "White",
                               "Scotland",
                               "Wales", 
                               "Constant"),
          dep.var.labels   = "Change in Personal Euroskepticism:",
          column.labels   = c("Moderate Conservatives", 
                              "Very Strong Conservatives"),
          model.numbers = FALSE,
          header = FALSE,
          star.cutoffs = c(0.05, 0.01,0.001),
          table.placement = "H")

# From the paper: There is a clear, statistically significant, positive 
# relationship between Conservative partisans’ perception of their party’s 
# increasing Euroskepticism and their own Euroskepticism. But the size of the 
# effect is limited: even for very strong Conservatives, a one-unit increase in 
# perceived Conservative Euroskepticism on a ten-point scale yields only a 0.22
# - unit increase in personal Euroskepticism. Unsurprisingly, as the relative 
# sizes of the two coefficients in the top row indicate, the effect is stronger 
# among Conservatives who described their partisan identity as very strong 
# before the referendum.

```

Table 3 reflects the results of the authors' exploration of an area of inquiry
adjacent to the paper's central question: post-referendum, do Conservatives 
experience evolution in Brexit policy preference, and does that evolution vary 
across strong and less strong Conservatives? In particular,"do strong partisans 
(e.g. very committed to Conservatives) change their policy preferences?" 
(Schonfeld and Winter-Levy 2019). Like the authors, I conducted this analysis by 
creating a variable - "Euroskepticismchange" - that represents the change in a 
given unit's level of Euroskepticism from Wave 8 to Wave 9 (from pre-referendum 
to post-referendum). Using the dataset subsetted to Wave 8 Conservatives/all 
Wave 9 data, I then further subsetted this dataset to create 2 datasets, 1 
representing units that characterized their affiliation to the Conservative
Party as "very strong," and another representing units that did not. For each 
dataset ("very strong" Conservatives, and those that are not), I then regressed 
"Euroskepticismchange" on perceived increase in Conservative Euroskepticism. As 
Table 3 indicates, "there is a clear, statistically significant, positive 
relationship between Conservative partisans’ perception of their party’s 
increasing Euroskepticism and their own Euroskepticism"; the value of the 
coefficient is higher for self-characterized "Very strong" Conservatives, as 
we'd expect.

Does this negate the authors' conclusion that policy rules over partisanship/
party affiliation? The authors argue no, not really -- as we can see in Table 3, 
"even for very strong Conservatives, a one-unit increase in perceived 
Conservative Euroskepticism on a ten-point scale yields only a 0.22-unit 
increase in personal Euroskepticism" (Schonfeld and Winter-Levy 2019), a 
relatively small value. Note that this value is significant at the 0.001 level.

```{r, echo = FALSE, warning = FALSE, message = FALSE}

### Let's create Figure 1 (which corresponds with Table 3):

# First, let's merge Waves 8 and 9:

bigmerge <- merge(BES8, BES9, by = "id")

# And create relevant values:

bigmerge$Euroskepticismchange <- bigmerge$EUIntegrationSelf9 - bigmerge$EUIntegrationSelf8
bigmerge$Conchange <- bigmerge$EUIntegrationCon9 - bigmerge$EUIntegrationCon8

# And now, let's subset to 3 groups:

bigmerge$Partisan[bigmerge$partyId8 != "Conservative"] <- "Non-Conservative"
bigmerge$Partisan[bigmerge$partyId8 == "Conservative" & bigmerge$partyIdStrength.x != "Very strong"] <- "Moderate Conservative"
bigmerge$Partisan[bigmerge$partyId8 == "Conservative" & bigmerge$partyIdStrength.x == "Very strong"] <- "Very Strong Conservative"

# And create relevant variables representing the 3 groups:

bigmergenon <- bigmerge[bigmerge$Partisan == "Non-Conservative",]
bigmergemod<- bigmerge[bigmerge$Partisan == "Moderate Conservative",]
bigmergever <- bigmerge[bigmerge$Partisan == "Very Strong Conservative",]

# What percentage of each group switched?

# mean(bigmergenon$Conchange, na.rm = TRUE)
# mean(bigmergemod$Conchange, na.rm = TRUE)
# mean(bigmergever$Conchange, na.rm = TRUE)

# mean(bigmergenon$Euroskepticismchang, na.rm = TRUE)
# mean(bigmergemod$Euroskepticismchang, na.rm = TRUE)
# mean(bigmergever$Euroskepticismchang, na.rm = TRUE)

bigmerge$Partisan <- factor(bigmerge$Partisan, levels = c("Non-Conservative", 
                                                          "Moderate Conservative", 
                                                          "Very Strong Conservative"))

# Let's make our ggplot:

# How to remove warnings here?

g <- ggplot(bigmerge, aes(y = Euroskepticismchange, x = Conchange, color = Partisan)) +
  geom_point(size = 0.1) + 
  stat_smooth(method = "lm",se = TRUE) +
  theme_bw() +
  xlab("Perceived Change in Conservative Euroskepticism") +
  ylab("Change in Personal Euroskepticism")

```

```{r, echo = FALSE, warning = FALSE, message = FALSE}

g

# From the paper: "The intensity of Conservative partisanship determined the 
# extent to which voters followed the party’s evolving position on the EU – or, 
# more precisely, their perception of the party’s evolving position."

```

Figure 1 is a visual display of the results discussed in Table 3; here, we can 
clearly see the relationship between a unit's perceived change in the 
Euroskepticism of the Conservative Party and their personal change in their 
views on Euroskepticism; for non-Conservatives, there's almost no relationship,
whilst the slope is positive and steeper for "Moderate Conservatives" and even
more steep for "Very Strong Conservatives," as we observed. These results are
best summarized by the authors themselves: "the intensity of Conservative 
partisanship determined the extent to which voters followed the party’s evolving 
position on the EU – or, more precisely, their perception of the party’s 
evolving position" (Schonfeld and Winter-Levy 2019).

```{r, echo = FALSE, warning = FALSE, message = FALSE}

### As previously non-Conservative Euroskeptics flocked to the party, what 
# happened to their views on other issues?

# From the paper: "We find that joining the Conservatives led voters to update 
# their views on economic issues to bring them into line with the positions of 
# their new party; party affiliation, we contend, influenced the subsequent 
# evolution of voters’ policy preferences.

# In particular, the authors examine attitudes around redistribution.

# Let's make Table 4 and the associated Figure 2 (which supports a key 
# assumption for us to draw inferences from Table 4):

# Let's start with some cleaning:

BES7 <- BES7 %>%
  mutate(redistSelf = case_when(redistSelf == "Government should try to make incomes equal" ~ 0,
                                redistSelf == "1" ~ 1, redistSelf== "2" ~ 2,
                                redistSelf == "3" ~ 3, redistSelf == "4" ~ 4,
                                redistSelf == "5" ~ 5, redistSelf == "6" ~ 6,
                                redistSelf == "7" ~ 7, redistSelf == "8" ~ 8,
                                redistSelf == "9" ~ 9, 
                                redistSelf == "Government should be less concerned about equal incomes" ~ 10))

BES7$redistSelf7 <- BES7$redistSelf
merged2 <- merge(merged2, BES7, by = "id")

BES11 <- BES11 %>%
  mutate(redistSelf = case_when(redistSelf== "Government should try to make incomes equal" ~ 0,
                                redistSelf == "1" ~ 1, redistSelf== "2" ~ 2, 
                                redistSelf == "3" ~ 3, redistSelf == "4" ~ 4,
                                redistSelf == "5" ~ 5, redistSelf == "6" ~ 6,
                                redistSelf == "7" ~ 7, redistSelf == "8" ~ 8,
                                redistSelf == "9" ~ 9,
                                redistSelf == "Government should be less concerned about equal incomes" ~ 10))

BES11$redistSelf11 <- BES11$redistSelf
merged2 <- merge(merged2, BES11, by = "id")

# From the paper: "We now estimate the effect of joining the Conservatives on changes in 
# attitudes towards redistribution. Our dependent variable, “Increase in 
# Opposition to Redistribution,” is the level of opposition to redistribution in 
# Wave 11, conducted between April 2017 and May 2017, minus the level of 
# opposition to redistribution in Wave 7 (conducted between April 2016 and May 
# 2016), the most recent post- and pre-referendum survey waves respectively that 
# ask about redistribution preferences." (A higher value suggests more 
# opposition to redistribution.)

merged2$redistchange <- merged2$redistSelf11 - merged2$redistSelf7

# From the paper: "We find a positive association between joining the 
# Conservatives and increased opposition to redistribution: as column 1 shows, 
# affiliating with the Conservative Party is associated with more than a 
# half-point increase in opposition to redistribution on a ten-point scale.

table4reg <- lm(redistchange ~ switchtocons + white + age.x + gender.x + 
                  country.x, data = merged2)

# People who were part of UKIP (should see negligible change, as discussed in
# the paper, as UKIP was already very opposed to redistribution):
 
regUKIP <- lm(redistchange ~ switchtocons + white + age.x +gender.x 
              + country.x, data = merged2, 
              partyId8 == "United Kingdom Independence Party (UKIP)")

# People who were not part of UKIP -- from the paper: "the effect of joining the 
# Conservatives on redistributive attitudes should be stronger among respondents 
# who were not previously members of UKIP."

regnonUKIP <- lm(redistchange ~ switchtocons + white + age.x +gender.x 
                 + country.x, data = merged2, 
                 partyId8 != "United Kingdom Independence Party (UKIP)")

```


```{r, results = 'asis', echo = FALSE}

# Let's create Table 4:

stargazer(table4reg, regnonUKIP, regUKIP, title = "Joining the Conservatives and 
          Opposition to Redistribution", no.space = TRUE,
           covariate.labels = c("Joined Conservatives", 
                               "White",
                               "Age",
                               "Female",
                               "Scotland",
                               "Wales", 
                               "Constant"),
          dep.var.labels   = "Change in Opposition to Redistribution",
          column.labels   = c("Overall", 
                              "Non-UKIP",
                              "UKIP"),
          header = FALSE,
          model.numbers = FALSE,
          star.cutoffs = c(0.05, 0.01,0.001),
          table.placement = "H")

```

The authors then turned to another interesting, related question: "As previously 
non-Conservative Euroskeptics flocked to the party, what happened to their views 
on other issues?" (Schonfeld and Winter-Levy 2019). In particular, the authors
were curious to see if these newly minted Conservatives adopted the Conservative
stance on other policy issues; this could shed light into whether "partisanship
shapes the development of voters' policy preferences" (Schonfeld and Winter-Levy 
2019).

To answer this question, the authors selected redistribution as the policy issue
they examined; they noted that it remains a key political issue in the UK. I
began by looking at Waves 7 and 11 (the pre and post-referendum surveys that ask
about redistribution). Like the authors, I created a new variable, "redistchange,"
which represents the change in the level of opposition to redistribution between
the 2 waves (a positive value suggests an increase in opposition). I then 
regressed this variable on our "switchtocons" variable (an indicator of whether
a given unit switched to the Conservative Party). I do this for the general 
dataset, as well as for 2 other specific datasets, one representing units that
switched to Conservative from the United Kingdom Independence Party (UKIP),
and another representing units that did not switch from UKIP. UKIP is a 
right-wing populist party already quite opposed to redistribution; with that 
said, "the effect of joining the Conservatives on redistributive attitudes 
should be stronger among respondents who were not previously members of UKIP"
(Schonfeld and Winter-Levy 2019).

As Table 4 shows us, overall, switching to the Conservative Party is associated 
with a 0.542 point increase in the level of opposition to redistribution on
a ten-point scale; this coefficient is significant at the 0.001 level. As
we'd expect, this value is even larger -- 0.605 -- for those switching from
a non-UKIP party; further, the coefficient remains significant at the 0.01 
level. Finally, though not significant at the 0.05 level, the coefficient 
associated with those switching from UKIP suggests an almost negligible change
(on a 10-point scale) in opposition to redistribution (as we'd expect).

```{r, echo = FALSE}

# Let's make the corresponding Figure 2:

BES7 <- BES7 %>%
  mutate(redistCon = case_when(redistCon== "Government should try to make incomes equal" ~ 0,
                               redistCon == "1" ~ 1, redistCon== "2" ~ 2,
                               redistCon == "3" ~ 3, redistCon == "4" ~ 4,
                               redistCon == "5" ~ 5, redistCon == "6" ~ 6,
                               redistCon == "7" ~ 7, redistCon == "8" ~ 8,
                               redistCon == "9" ~ 9, 
                               redistCon == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistGreen = case_when(redistGreen== "Government should try to make incomes equal" ~ 0,
                                 redistGreen == "1" ~ 1, redistGreen== "2" ~ 2,
                                 redistGreen == "3" ~ 3, redistGreen == "4" ~ 4,
                                 redistGreen == "5" ~ 5, redistGreen == "6" ~ 6,
                                 redistGreen == "7" ~ 7, redistGreen == "8" ~ 8,
                                 redistGreen == "9" ~ 9,
                                 redistGreen == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistLab = case_when(redistLab== "Government should try to make incomes equal" ~ 0,
                               redistLab == "1" ~ 1, redistLab== "2" ~ 2,
                               redistLab == "3" ~ 3, redistLab == "4" ~ 4,
                               redistLab == "5" ~ 5, redistLab == "6" ~ 6,
                               redistLab == "7" ~ 7, redistLab == "8" ~ 8,
                               redistLab == "9" ~ 9,
                               redistLab == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistLD = case_when(redistLD== "Government should try to make incomes equal" ~ 0,
                              redistLD == "1" ~ 1, redistLD== "2" ~ 2,
                              redistLD == "3" ~ 3, redistLD == "4" ~ 4,
                              redistLD == "5" ~ 5, redistLD == "6" ~ 6,
                              redistLD == "7" ~ 7,redistLD == "8" ~ 8,
                              redistLD == "9" ~ 9,
                              redistLD == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistPC = case_when(redistPC== "Government should try to make incomes equal" ~ 0,
                              redistPC == "1" ~ 1, redistPC== "2" ~ 2,
                              redistPC == "3" ~ 3, redistPC == "4" ~ 4,
                              redistPC == "5" ~ 5, redistPC == "6" ~ 6,
                              redistPC == "7" ~ 7, redistPC == "8" ~ 8,
                              redistPC == "9" ~ 9,
                              redistPC == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistSNP = case_when(redistSNP== "Government should try to make incomes equal" ~ 0,
                               redistSNP == "1" ~ 1, redistSNP== "2" ~ 2,
                               redistSNP == "3" ~ 3, redistSNP == "4" ~ 4,
                               redistSNP == "5" ~ 5, redistSNP == "6" ~ 6,
                               redistSNP == "7" ~ 7, redistSNP == "8" ~ 8,
                               redistSNP == "9" ~ 9,
                               redistSNP == "Government should be less concerned about equal incomes" ~ 10))

BES7 <- BES7 %>%
  mutate(redistUKIP = case_when(redistUKIP== "Government should try to make incomes equal" ~ 0,
                                redistUKIP == "1" ~ 1, redistUKIP== "2" ~ 2,
                                redistUKIP == "3" ~ 3, redistUKIP == "4" ~ 4,
                                redistUKIP == "5" ~ 5, redistUKIP == "6" ~ 6,
                                redistUKIP == "7" ~ 7, redistUKIP == "8" ~ 8,
                                redistUKIP == "9" ~ 9, redistUKIP == "Government should be less concerned about equal incomes" ~ 10))

# Find average perceived opposition to redistribution by party for Wave 7: 

con7 <- mean(BES7$redistCon, na.rm=TRUE)
green7 <- mean(BES7$redistGreen, na.rm=TRUE)
lab7 <- mean(BES7$redistLab, na.rm=TRUE)
ld7 <- mean(BES7$redistLD, na.rm=TRUE)
pc7 <- mean(BES7$redistPC, na.rm=TRUE)
snp7 <- mean(BES7$redistSNP, na.rm=TRUE)
ukip7 <- mean(BES7$redistUKIP, na.rm=TRUE)

# And now the same for Wave 11:

BES11 <- BES11 %>%
  mutate(redistCon = case_when(redistCon == "Government should try to make incomes equal" ~ 0,
                               redistCon == "1" ~ 1, redistCon== "2" ~ 2,
                               redistCon == "3" ~ 3, redistCon == "4" ~ 4,
                               redistCon == "5" ~ 5, redistCon == "6" ~ 6,
                               redistCon == "7" ~ 7, redistCon == "8" ~ 8,
                               redistCon == "9" ~ 9, 
                               redistCon == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistGreen = case_when(redistGreen == "Government should try to make incomes equal" ~ 0,
                                 redistGreen == "1" ~ 1, redistGreen== "2" ~ 2, 
                                 redistGreen == "3" ~ 3, redistGreen == "4" ~ 4,
                                 redistGreen == "5" ~ 5, redistGreen == "6" ~ 6,
                                 redistGreen == "7" ~ 7, redistGreen == "8" ~ 8,
                                 redistGreen == "9" ~ 9, 
                                 redistGreen == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistLab = case_when(redistLab== "Government should try to make incomes equal" ~ 0,
                               redistLab == "1" ~ 1, redistLab== "2" ~ 2,
                               redistLab == "3" ~ 3, redistLab == "4" ~ 4,
                               redistLab == "5" ~ 5, redistLab == "6" ~ 6,
                               redistLab == "7" ~ 7, redistLab == "8" ~ 8,
                               redistLab == "9" ~ 9, 
                               redistLab == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistLD = case_when(redistLD== "Government should try to make incomes equal" ~ 0,
                              redistLD == "1" ~ 1, redistLD== "2" ~ 2,
                              redistLD == "3" ~ 3, redistLD == "4" ~ 4,
                              redistLD == "5" ~ 5,redistLD == "6" ~ 6,
                              redistLD == "7" ~ 7,redistLD == "8" ~ 8,
                              redistLD == "9" ~ 9, 
                              redistLD == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistPC = case_when(redistPC== "Government should try to make incomes equal" ~ 0,
                              redistPC == "1" ~ 1, redistPC== "2" ~ 2,
                              redistPC == "3" ~ 3, redistPC == "4" ~ 4,
                              redistPC == "5" ~ 5, redistPC == "6" ~ 6,
                              redistPC == "7" ~ 7, redistPC == "8" ~ 8,
                              redistPC == "9" ~ 9, 
                              redistPC == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistSNP = case_when(redistSNP== "Government should try to make incomes equal" ~ 0,
                               redistSNP == "1" ~ 1, redistSNP== "2" ~ 2, 
                               redistSNP == "3" ~ 3, redistSNP == "4" ~ 4,
                               redistSNP == "5" ~ 5, redistSNP == "6" ~ 6,
                               redistSNP == "7" ~ 7, redistSNP == "8" ~ 8,
                               redistSNP == "9" ~ 9, 
                               redistSNP == "Government should be less concerned about equal incomes" ~ 10))

BES11 <- BES11 %>%
  mutate(redistUKIP = case_when(redistUKIP== "Government should try to make incomes equal" ~ 0,
                                redistUKIP == "1" ~ 1, redistUKIP== "2" ~ 2,
                                redistUKIP == "3" ~ 3, redistUKIP == "4" ~ 4,
                                redistUKIP == "5" ~ 5, redistUKIP == "6" ~ 6,
                                redistUKIP == "7" ~ 7, redistUKIP == "8" ~ 8,
                                redistUKIP == "9" ~ 9, 
                                redistUKIP == "Government should be less concerned about equal incomes" ~ 10))

# Find average perceived opposition to redistribution by party for Wave 11:

con11 <- mean(BES11$redistCon, na.rm = TRUE)
green11 <- mean(BES11$redistGreen, na.rm = TRUE)
lab11 <- mean(BES11$redistLab, na.rm = TRUE)
ld11 <- mean(BES11$redistLD, na.rm = TRUE)
pc11 <- mean(BES11$redistPC, na.rm = TRUE)
snp11 <- mean(BES11$redistSNP, na.rm = TRUE)
ukip11 <- mean(BES11$redistUKIP, na.rm = TRUE)

## Create self-constructed dataframe of perception scores based on above code):

party7 <- c("Conservative", "Green", "Labour", "Lib Dem", "Plaid Cymru", "SNP",
           "UKIP")
perceived_opp7 <- c(con7, green7, lab7, ld7, pc7, snp7, ukip7)
redistribution7 <- data.frame(party7, perceived_opp7)

# And finally, let's make Figure 2: 

# Plot Wave 7 values of opposition to redistribution by party:
g7 <- ggplot(redistribution7, aes(y = perceived_opp7, 
                         x = party7)) + 
  geom_bar(stat = "identity", width = 0.5, color = "black", fill = "blue") +
  stat_smooth(method ="lm", se = FALSE) +  
  theme_bw() +
  xlab("Party") + 
  ylab("Perceived Opposition to Redistribution (Wave 7)") +
  labs(title = "Wave 7 Values of Perceived Opposition to Redistribution")

# And now, the same thing for Wave 11:

party11 <- c("Conservative", "Green", "Labour", "Lib Dem", "Plaid Cymru", "SNP",
           "UKIP")
perceived_opp11 <- c(con11, green11, lab11, ld11, pc11, snp11, ukip11)
redistribution11 <- data.frame(party11, perceived_opp11)

# Plot Wave 11 values of opposition to redistribution by party:

g11 <- ggplot(redistribution11,
              aes(y = perceived_opp11, x = party11)) +
  geom_bar(stat ="identity", width=0.5, color="black", fill="blue") +
  stat_smooth(method = "lm",se = FALSE) + 
  theme_bw() +
  xlab("Party") + 
  ylab("Perceived Opposition to Redistribution (Wave 11)") +
  labs(title = "Wave 11 Values of Perceived Opposition to Redistribution")

```

```{r, echo = FALSE, warning = FALSE, message = FALSE}

g7
g11

```

Figure 2 (both graphs) supports Table 4; in particular, they help support our 
assumption that affiliating with the Conservative Party should -- if partisan
affiliation influences policy preferences -- lead to an increase in opposition
to redistribution. As the graphs show, "the Conservatives were the most 
anti-redistribution party in both Wave 7 – before the referendum – and Wave 11
– after the referendum" (Schonfeld and Winter-Levy 2019).

```{r, echo = FALSE}

### But has changing partisanship influenced actual voting?

# From the paper: "Although we cannot identify causality for changes in electoral voting, we 
# analyze actual voting behavior to examine the broader implications of the 
# Brexit-induced change in Conservative positioning. We assess the relationship 
# between Euroskepticism and voting in the 2015 and 2017 elections by drawing on 
# data from British Election Study Wave 6 (conducted in May 2015, in the 
# immediate aftermath of the 2015 election) and Wave 13 (conducted after the 
# June 2017 election)."

# Let's start with some cleaning:

# Let's begin creating a race variable:

BES6$white <- ifelse(BES6$profile_ethnicity == "White British" | BES6$profile_ethnicity == "Any other white background", 1, 0)

# Let's also recode EU integration:

BES6 <- BES6 %>%
  mutate(EUIntegrationCon = case_when(EUIntegrationCon == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationCon == "1" ~ 1, EUIntegrationCon == "2" ~ 2,
                                      EUIntegrationCon == "3" ~ 3, EUIntegrationCon == "4" ~ 4,
                                      EUIntegrationCon == "5" ~ 5, EUIntegrationCon == "6" ~ 6,
                                      EUIntegrationCon == "7" ~ 7, EUIntegrationCon == "8" ~ 8,
                                      EUIntegrationCon == "9" ~ 9,
                                      EUIntegrationCon == "Protect our independence" ~ 10))
BES6 <- BES6 %>%
  mutate(EUIntegrationLab = case_when(EUIntegrationLab == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationLab == "1" ~ 1, EUIntegrationLab == "2" ~ 2,
                                      EUIntegrationLab == "3" ~ 3, EUIntegrationLab == "4" ~ 4,
                                      EUIntegrationLab == "5" ~ 5, EUIntegrationLab == "6" ~ 6,
                                      EUIntegrationLab == "7" ~ 7, EUIntegrationLab == "8" ~ 8,
                                      EUIntegrationLab == "9" ~ 9,
                                      EUIntegrationLab == "Protect our independence" ~ 10))

BES6$generalElectionVote15 <- BES6$generalElectionVote
BES6$EUIntegrationLab15 <- BES6$EUIntegrationLab
BES6$EUIntegrationCon15 <- BES6$EUIntegrationCon

BES6 <- BES6 %>%
  mutate(EUIntegrationSelf = case_when(EUIntegrationSelf == "Unite fully with the European Union" ~ 0,
                                       EUIntegrationSelf == "1" ~ 1, EUIntegrationSelf == "2" ~ 2,
                                       EUIntegrationSelf == "3" ~ 3, EUIntegrationSelf == "4" ~ 4,
                                       EUIntegrationSelf == "5" ~ 5, EUIntegrationSelf == "6" ~ 6,
                                       EUIntegrationSelf == "7" ~ 7, EUIntegrationSelf == "8" ~ 8,
                                       EUIntegrationSelf == "9" ~ 9, 
                                       EUIntegrationSelf == "Protect our independence" ~ 10))
BES6$EUIntegrationSelf6 <- BES6$EUIntegrationSelf



# Conservative vote variable:

BES6$Convote <- ifelse(BES6$generalElectionVote15 == "Conservative", 1, 0)

# Conservative subset:

BES6con <- BES6[BES6$Convote == 1,]

# Non-Conservative subset:

BES6notcon <- BES6[BES6$Convote == 0,]

# Vote choice variable:

BES13$generalElectionVote17 <- BES13$generalElectionVote

# Once again, recode integration values -- this time, for Wave 13:

BES13 <- BES13 %>%
  mutate(EUIntegrationSelf = case_when(EUIntegrationSelf == "Unite fully with the European Union"~ 0,
                                       EUIntegrationSelf == "1" ~ 1, EUIntegrationSelf == "2" ~ 2,
                                       EUIntegrationSelf == "3" ~ 3, EUIntegrationSelf == "4" ~ 4,
                                       EUIntegrationSelf == "5" ~ 5, EUIntegrationSelf == "6" ~ 6,
                                       EUIntegrationSelf == "7" ~ 7, EUIntegrationSelf == "8" ~ 8,
                                       EUIntegrationSelf == "9" ~ 9, 
                                       EUIntegrationSelf == "Protect our independence" ~ 10))
BES13$EUIntegrationSelf13 <- BES13$EUIntegrationSelf

BES13 <- BES13 %>%
  mutate(EUIntegrationCon = case_when(EUIntegrationCon == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationCon == "1" ~ 1, EUIntegrationCon == "2" ~ 2,
                                      EUIntegrationCon == "3" ~ 3, EUIntegrationCon == "4" ~ 4,
                                      EUIntegrationCon == "5" ~ 5, EUIntegrationCon == "6" ~ 6,
                                      EUIntegrationCon == "7" ~ 7, EUIntegrationCon == "8" ~ 8,
                                      EUIntegrationCon == "9" ~ 9,
                                      EUIntegrationCon == "Protect our independence" ~ 10))

BES13 <- BES13 %>%
  mutate(EUIntegrationLab = case_when(EUIntegrationLab == "Unite fully with the European Union" ~ 0,
                                      EUIntegrationLab == "1" ~ 1, EUIntegrationLab == "2" ~ 2,
                                      EUIntegrationLab == "3" ~ 3, EUIntegrationLab == "4" ~ 4,
                                      EUIntegrationLab == "5" ~ 5, EUIntegrationLab == "6" ~ 6,
                                      EUIntegrationLab == "7" ~ 7, EUIntegrationLab == "8" ~ 8,
                                      EUIntegrationLab == "9" ~ 9, 
                                      EUIntegrationLab == "Protect our independence" ~ 10))

BES13$generalElectionVote17 <- BES13$generalElectionVote
BES13$EUIntegrationLab17 <- BES13$EUIntegrationLab
BES13$EUIntegrationCon17 <- BES13$EUIntegrationCon

# Merge the people who voted Con in 2015:

BES13con <- merge(BES6con, BES13, by = "id")
BES13con$Conchange <- BES13con$EUIntegrationCon17 - BES13con$EUIntegrationCon15
BES13con$voteswitcher <- ifelse(BES13con$generalElectionVote17 != BES13con$generalElectionVote15, 1, 0)

# Run the regressions we'll include in Table 5 (below)!

# From the paper: "We first examine survey respondents who reported voting for 
# the Conservatives in the 2015 election. In Table 5, we test whether a 
# Conservative voter’s level of Euroskepticism in 2015 is related to the 
# probability the voter decides to back the Conservatives in 2017.

GG <- lm(voteswitcher ~ EUIntegrationSelf6, data = BES13con)
HH <- lm(voteswitcher ~ EUIntegrationSelf6 * Conchange, data = BES13con)
II <- lm(voteswitcher ~ EUIntegrationSelf6 * Conchange + age + gender.x + 
           white + country.x, data = BES13con)

```


```{r, results = 'asis', echo = FALSE}

# And now, finally, let's create Table 5:

stargazer(GG, HH, II, 
          title = "Euroskepticism and Defecting from Conservatives",
          no.space = TRUE,
          covariate.labels = c("2015 Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism",
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales",
                               "Interaction",
                               "Constant"),
          dep.var.labels   = "Defected from Conservatives",
          font.size = "tiny",
          header = FALSE,
          star.cutoffs = c(0.05, 0.01, 0.001))

# From the paper: "We find a consistent negative relationship between 2015 
# Euroskepticism and the likelihood of defecting from the (now more Euroskeptic) 
# Conservatives in 2017. The effects are substantively large: a one-unit 
# increase in Euroskepticism on the ten-point scale (in 2015) makes someone 2.9 
# percent less likely to abandon the Conservatives in the 2017 election."

```

Finally, the authors ask one last, related (and once again, fascinating) 
question: yes, we've observed changing partisanship, but "has changing 
partisanship influenced actual voting?" (Schonfeld and Winter-Levy 2019). While, 
as the authors point out, it's impossible to isolate causality for voting 
changes, we can still "assess the relationship between Euroskepticism
and voting in the UK's 2015 and 2017 elections" (Schonfeld and Winter-Levy 
2019).

Like the authors, I began by looking at individuals who reported voting for the
Conservative Party in 2015 (pre-referendum). I then created a "voteswitcher" 
variable, which indicated if a given unit ultimately defected/voted for another
party in 2017. I regressed voteswitcher on the voter's level of Euroskepticism 
in 2015; in 2 other regressions, I added perceived changes in the Euroskepticism 
of the Conservative Party as an interaction, as well as threw in a bunch of 
relevant covariates.

The results suggest that there is a relatively strong negative relationship 
between 2015 Euroskepticism and the likelihood of defecting from the 
Conservative Party in the 2017 election; indeed, "a one-unit increase in 
Euroskepticism (on the ten-point scale) in 2015 makes someone 2.9 percent less 
likely to abandon the Conservatives in the 2017 election." This coefficient
is significant at the 0.001 level.

```{r, echo = FALSE}

### What about non-Conservatives?

# From the paper: "Next, we examine survey respondents who did not vote for the 
# Conservatives in the 2015 election." 

# People who did not vote for the Conservatives in the 2015 election:

BES13notcon <- merge(BES6notcon, BES13, by = "id")
BES13notcon$Conchange <- BES13notcon$EUIntegrationCon17 - BES13notcon$EUIntegrationCon15
BES13notcon$switchtocon <- ifelse(BES13notcon$generalElectionVote17 == "Conservative", 
                                  1, 0)

G <- lm(switchtocon ~ EUIntegrationSelf6, data = BES13notcon)
H <- lm(switchtocon ~ EUIntegrationSelf6 * Conchange, data = BES13notcon)
I <-  lm(switchtocon ~ EUIntegrationSelf6 * Conchange + age + gender.x + white 
         + as.factor(country.x), data = BES13notcon)

```

```{r, results = 'asis', echo = FALSE}

# And finally, Table 6:

stargazer(G, H, I, 
          title = "Euroskepticism and Switching Vote to Conservatives",
          no.space = TRUE, 
          covariate.labels = c("2015 Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism",
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales",
                               "Interaction",
                               "Constant"),
          dep.var.labels   = "Switched to Conservatives",
          font.size = "tiny",
          header = FALSE,
          star.cutoffs = c(0.05, 0.01,0.001),
          table.placement = "H")

# From the paper: "Using Ordinary Least Squares regression (displayed in Table 
# 6), we find a clear positive relationship between their level of 
# Euroskepticism in 2015 and the probability they voted for the Conservatives in 
# 2017. A one-unit increase in 2015 Euroskepticism (on the ten-point scale) 
# makes a non-Conservative as much as 4.7 percent more likely to vote for the 
# Conservatives in 2017. The consequences of the Conservative Party’s embrace of 
# Brexit, this analysis suggests, extend beyond voters’ partisan identities and 
# self-reported policy preferences to their behavior in the voting booth."

```

What about non-Conservatives? In Table 6, the authors extend their analysis in 
Table 5 to answer exactly that question. Here, I began by looking at individuals 
who reported not voting for the Conservative Party in 2015 (pre-referendum); 
I then created a "switchtocon" variable that indicated if a given unit ultimately 
switched to the Conservative Party in 2017. Once again, I regressed my 
"switchtocon" variable on voters' level of Euroskepticism in 2015, creating
2 other regressions, 1 with perceived changes in the Euroskepticism of the 
Conservative Party as an interaction, and another with a number of additional
covariates.

The results suggest the relationship we'd expect: a one-unit increase (on a 10-
point scale) in a non-Conservative voter's level of Euroskepticism in 2015 is 
associated with a 4.7% increase in the likelihood of voting for the Conservative
Party in 2017. Once again, this coefficient is significant at the 0.001 level.

# III. Proposed Extension

In replicating the results of this paper, I noticed an area for potential 
extension of the authors' original results: as discussed above, Tables 1 and
2, which examine the probability of defecting from the Conservative Party and 
probability of switching to the Conservative Party, respectively, as a function 
of an individual's pre-referendum level of Euroskepticism, have a
binary outcome/dependent variable (partyswitcher and switchtocon are indicator
variables, with 1 indicating defection/switching, and 0 indicating otherwise).
As described in Gelman and Hill, "logistic regression is the standard way to 
model binary outcomes" (Gelman and Hill 2007). What if, I wondered, I performed
the regressions summarized in Table 1 and 2 via logistic regression? Would
the results change; otherwise, would we be able to see any interesting findings?

```{r, echo = FALSE}

# Let's perform the Table 1 regressions using logistic regression:

table1reg_logistic <- glm(formula = partyswitcher ~ EUIntegrationSelf8,
                          family = binomial(link = "logit"),
                          data = merged)

intreg1_logistic <- glm(partyswitcher ~ EUIntegrationSelf8 * Conchange, 
               family = binomial(link = "logit"),
               data = merged)

intreg1a_logistic <- glm(partyswitcher ~ EUIntegrationSelf8 * Conchange + age.x 
                + gender.x + white + country.x,
                family = binomial(link = "logit"),
                data = merged)

```


```{r, results = 'asis', echo = FALSE}

# Now, let's recreate Table 1:

stargazer(table1reg_logistic, intreg1_logistic, intreg1a_logistic, 
          title = "Euroskepticism and Defection from the Conservatives (Logistic)",
          covariate.labels = c("Pre-Referendum Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism", 
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales", 
                               "Pre-Referendum Euroskepticism:Perceived Change in Conservative Euroskepticism", 
                               "Constant"),
          dep.var.labels   = "Defect from Conservatives",
          no.space = TRUE, star.cutoffs = c(0.05, 0.01, 0.001),
          font.size = "tiny",
          header = FALSE)

```

```{r, echo = FALSE}

# Let's use the sjPlot package to plot the last model (with the interaction,
# and all of the covariates) in both its lm() and logistic form:

plot1lm_noprob <- plot_model(intreg1a, show.values = TRUE, 
           title = "Defection Model Estimates (Lm)", value.offset = 0.3,
           digits = 5)
plot1log_noprob <- plot_model(intreg1a_logistic, show.values = TRUE, 
           title = "Defection Model Estimates (Logistic)", value.offset = 0.3,
           digits = 5)

# And here, we can look at the probabilities:

plot1lm_prob <-  plot_model(intreg1a, transform = "plogis", show.values = TRUE, 
           title = "Defection Model Probability Estimates (Lm)", 
           value.offset = 0.3,
           digits = 5)
plot1log_prob <- plot_model(intreg1a_logistic, transform = "plogis", show.values = TRUE, 
           title = "Defection Model Probability Estimates (Logistic)", 
           value.offset = 0.3,
           digits = 5)

# Question For Le: What should I go ahead and conclude from this (if at all)? 
# Right now, it seems to me like we get a more sophisticated picture with 
# logistic?

```

```{r, echo = FALSE}

plot1lm_noprob
plot1log_noprob
plot1lm_prob
plot1log_prob

```

```{r, echo = FALSE}

# Let's perform the Table 2 regressions using logistic regression:

table2reg_logistic <- glm(switchtocons ~ merged2$EUIntegrationSelf8,
                         family = binomial(link = "logit"),
                          data = merged2)

intreg2_logistic <- glm(switchtocons ~ EUIntegrationSelf8 * Conchange,
                       family = binomial(link = "logit"),
                          data = merged2)

intreg2a_logistic <- glm(switchtocons ~ EUIntegrationSelf8 * Conchange 
              + age.x + gender.x + white + as.factor(country.x),
              family = binomial(link = "logit"),
                          data = merged2)

```

```{r, results = 'asis', echo = FALSE}

# Now, let's recreate Table 2:

stargazer(table2reg_logistic, intreg2_logistic, intreg2a_logistic, 
          title = "Euroskepticism and Joining the Conservatives (Logistic)",
          covariate.labels = c("Pre-Referendum Euroskepticism", 
                               "Perceived Change in Conservative Euroskepticism", 
                               "Age",
                               "Female",
                               "White",
                               "Scotland",
                               "Wales", 
                               "Pre-Referendum Euroskepticism:Perceived Change in Conservative Euroskepticism", 
                               "Constant"),
          dep.var.labels   = "Joined Conservatives",
          no.space = TRUE, star.cutoffs = c(0.05, 0.01, 0.001),
          font.size = "tiny",
          header = FALSE)

```

```{r, echo = FALSE}

# Let's use the sjPlot package to plot the last model (with the interaction,
# and all of the covariates) in both its lm() and logistic form:

plot2lm_noprob <- plot_model(intreg2a, show.values = TRUE, 
           title = "Defection Model Estimates (Lm)", value.offset = 0.3,
           digits = 5)
plot2log_noprob <- plot_model(intreg2a_logistic, show.values = TRUE, 
           title = "Defection Model Estimates (Logistic)", value.offset = 0.3,
           digits = 5)

# And here, we can look at the probabilities:

plot2lm_prob <-  plot_model(intreg2a, transform = "plogis", show.values = TRUE, 
           title = "Defection Model Probability Estimates (Lm)", 
           value.offset = 0.3,
           digits = 5)
plot2log_prob <- plot_model(intreg2a_logistic, transform = "plogis", show.values = TRUE, 
           title = "Defection Model Probability Estimates (Logistic)", 
           value.offset = 0.3,
           digits = 5)

```

```{r, echo = FALSE}

plot2lm_noprob
plot2log_noprob
plot2lm_prob
plot2log_prob

```

# Ignore - Delete Before Submitting:

```{r, results = 'asis'}

# Look at the table, and say that the findings stay the same; the authors 
# ultimately didn't have a ton to gain by pursuing logistic regression.

# Le: Maybe look at interaction and the other 2 model
# sjPlot; plot_model - compare to linear model

# Let's look at the null and residual deviance for our last model:

pchisq(3209.2 - 3176.4, 6215 - 6207, lower = FALSE)

# We're definitely in the tail, which suggests that our model is statistically 
# different from the mean model. That's good!

# Let's look at the odds ratios:

exp(table1reg_logistic$coefficients[])

# Question for Le: How should I interpret/consider the logistic regression
# approach -- in particular, how should I compare it to the "regular" lm
# approach utilized in the paper?

# Can plot some graphs -- look at the magnitudes across the scales of indep.
# variable. 

merged %>% 
  ggplot(aes(EUIntegrationSelf8, partyswitcher)) +
  geom_point() +
  stat_smooth(method = "glm", se = FALSE,
              method.args = list(binomial(link = "logit"))) +
  theme_minimal() +
  labs(title = "Logistic regression is...",
       subtitle = "")


merged %>% 
  ggplot(aes(EUIntegrationSelf8, partyswitcher)) +
  geom_point() +
  stat_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = "Linear regression is...",
       subtitle = "")

binnedplot(x = intreg1a_logistic$fitted.values, 
           y = resid(intreg1a_logistic, type = "response"))

# Can do some inverse-logit/predict -- can define high level and a low level; compare
# 1 to 2, 2 to 3, etc. -- and discuss your findings in your report.

# Initial attempt at interpretation of Table 1 logistic regressions:

# Here, for each model, we calculate the odds ratio of the various coefficients; the odds
# ratio represents: P/1-P (or the probability of leaving the Conservatives/the
# probability of not leaving the Conservatives). With that said, if the value of
# an odds ratio is > 1, then the ratio suggests the predictor is associated with
# an increase in the probability of leaving the Conservatives. The magnitude of 
# that effect can be directly compared via the numbers, with adjustment for 
# variation via multiplication by the standard deviation.

# Let's consider the most simple regression/model: 

# The odds ratio for EUIntegrationSelf8 is 0.9672463; this suggests that a one-unit increase
# in pre-referendum Euroskepticism is associated with a decrease in the
# probability of defection from the Conservatives (as we would predict, given
# that the Conservatives adopt an anti-integration view post-referendum).

#...

```

# IV. Bibliography

https://poseidon01.ssrn.com/delivery.php?ID=527000067124025067095113075070106108039003024042071075093075112088116127097094006067114102007027106035006118101118066012029092005082039040022085029077121099027079010057077009093030070064114126083093115081011094012094102027115097065022064028007111101001&EXT=pdf&INDEX=TRUE

https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/QVTCYP